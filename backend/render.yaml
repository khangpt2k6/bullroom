services:
  # API Gateway
  - type: web
    name: bullroom-api-gateway
    env: node
    region: oregon
    plan: starter
    buildCommand: npm install && cd api-gateway && npm install && npm run build
    startCommand: node api-gateway/dist/api-gateway/server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: MONGODB_URI
        sync: false
      - key: REDIS_URL
        sync: false
      - key: RABBITMQ_URL
        sync: false
      - key: CLERK_SECRET_KEY
        sync: false
    healthCheckPath: /health

  # Booking Service
  - type: web
    name: bullroom-booking-service
    env: node
    region: oregon
    plan: starter
    buildCommand: npm install && cd booking-service && npm install && npm run build
    startCommand: node booking-service/dist/booking-service/server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3001
      - key: MONGODB_URI
        sync: false
      - key: REDIS_URL
        sync: false
      - key: RABBITMQ_URL
        sync: false
      - key: CLERK_SECRET_KEY
        sync: false

  # Notification Service
  - type: web
    name: bullroom-notification-service
    env: node
    region: oregon
    plan: starter
    buildCommand: npm install && cd notification-service && npm install && npm run build
    startCommand: node notification-service/dist/notification-service/server.js
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3002
      - key: MONGODB_URI
        sync: false
      - key: REDIS_URL
        sync: false
      - key: RABBITMQ_URL
        sync: false
      - key: CLERK_SECRET_KEY
        sync: false
      - key: RESEND_API_KEY
        sync: false
      - key: FROM_EMAIL
        sync: false
